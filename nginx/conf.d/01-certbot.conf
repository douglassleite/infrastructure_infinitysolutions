# ===========================================
# Certbot HTTP Challenge Server
# Aceita requisições HTTP para validação Let's Encrypt
# e redireciona o resto para HTTPS
# ===========================================

# Domínios principais (sempre ativos)
server {
    listen 80;
    server_name www.infinityitsolutions.com.br
                infinityitsolutions.com.br
                personalweb.infinityitsolutions.com.br
                personalapi.infinityitsolutions.com.br
                evolly.infinityitsolutions.com.br;

    # Certbot challenge
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    # Redirect all other traffic to HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# Domínios adicionais (qualquer outro domínio)
# Redireciona para HTTPS automaticamente
server {
    listen 80 default_server;
    server_name _;

    # Certbot challenge
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    # Redirect para HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}
